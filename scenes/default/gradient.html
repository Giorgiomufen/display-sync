<!DOCTYPE html>
<html>
<head>
  <style>
    * { margin: 0; padding: 0; }
    body { overflow: hidden; }
    canvas { display: block; }
  </style>
</head>
<body>
<canvas id="c"></canvas>
<script>
var canvas = document.getElementById('c');
var ctx = canvas.getContext('2d');
var time = 0;
var displayId = 1;
var displayCount = 3;
var speed = 1;
var intensity = 1;

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener('resize', resize);

function hslToRgb(h, s, l) {
  var r, g, b;
  if (s === 0) {
    r = g = b = l;
  } else {
    var hue2rgb = function(p, q, t) {
      if (t < 0) t += 1;
      if (t > 1) t -= 1;
      if (t < 1/6) return p + (q - p) * 6 * t;
      if (t < 1/2) return q;
      if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
      return p;
    };
    var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
    var p = 2 * l - q;
    r = hue2rgb(p, q, h + 1/3);
    g = hue2rgb(p, q, h);
    b = hue2rgb(p, q, h - 1/3);
  }
  return { r: Math.round(r * 255), g: Math.round(g * 255), b: Math.round(b * 255) };
}

function render() {
  time++;
  var offset = (displayId - 1) / displayCount;
  var hue = ((time * 0.02 * speed) + offset) % 1;
  var grad = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
  var c1 = hslToRgb(hue, 0.8, 0.5 * intensity);
  var c2 = hslToRgb((hue + 0.3) % 1, 0.8, 0.4 * intensity);
  var c3 = hslToRgb((hue + 0.6) % 1, 0.8, 0.5 * intensity);
  grad.addColorStop(0, 'rgb(' + c1.r + ',' + c1.g + ',' + c1.b + ')');
  grad.addColorStop(0.5, 'rgb(' + c2.r + ',' + c2.g + ',' + c2.b + ')');
  grad.addColorStop(1, 'rgb(' + c3.r + ',' + c3.g + ',' + c3.b + ')');
  ctx.fillStyle = grad;
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  requestAnimationFrame(render);
}

window.addEventListener('message', function(e) {
  if (e.data.displayId) displayId = e.data.displayId;
  if (e.data.displayCount) displayCount = e.data.displayCount;
  if (e.data.speed !== undefined) speed = e.data.speed;
  if (e.data.intensity !== undefined) intensity = e.data.intensity;
});

render();
</script>
</body>
</html>
